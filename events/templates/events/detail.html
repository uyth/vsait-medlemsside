<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>{{ event.event_name }}</title>
		{% load static %}
		<link rel="stylesheet" type="text/css" href="{% static 'home/style.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'events/style.css' %}">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
	</head>
	<body>
		<div class="wrapper">
			{% block header %}
				{% include 'home/header.html' %} 
			{% endblock header %}
			<main>
				<div class="splash">
					<div>
						<h1>Vietnamese Student Association</h1>
					</div>
				</div>
				<div class="innhold">
					<div class="bilde">
						<img src="{{ event.image.url }}" alt="event image"></img>
					</div>
					<div class="flexbox">
						<div class="box1">
							<h1>{{ event.title }}</h1>
							<p><span class="label">Last edited:</span> {{ event.last_edited | date:'d.m.Y, H:i'}}</p>
							<div class="info">
								{{ event.description | safe }}
							</div>
						</div>
						<div class="box2">
							<div class="oppmote">
								<p class="label">Starttime</p>
								<p>{{ event.startTime | date:'d.m.Y, H:i'}}</p>
								<p class="label">Endtime</p>
								<p>{{ event.endTime | date:'d.m.Y, H:i'}}</p>
								<p class="label">Registration deadline</p>
								<p>{{ event.registrationDeadline | date:'d.m.Y, H:i'}}</p>
								<p class="label">Cancellation deadline</p>
								<p>{{ event.cancellationDeadline | date:'d.m.Y, H:i'}}</p>
								<p class="label">Location</p>
								<p>{{ event.location }}</p>
							</div>
						</div>
					</div>
					<div class="flexbox">
						<div>
							<p>INFO</p>
							<p>En liten infoboks på hver event som forklarer påmelding, avmelding, venteliste, deadline, mat</p>
						</div>
					</div>
					<div class="paamelding">
						<div class="box3">
							<div>
								<p class="label">Registered</p>
								<p>{{ event.number_of_registrations }} / {{ event.display_max_people }}</p>
							</div>
							{% if not event.max_people_unlimited %}
							<div>
								<p class="label">Waiting list</p>
								<p>{% if is_waiting %} Currently in position {{ waiting_number }} / {% endif %}{{ event.number_of_waiting_users }}</p>
							</div>
							{% endif %}
						</div>
						{% if can_register %}
							{% if user.is_authenticated %}
							<form action="/events/register/{{event.pk}}" method="POST">
								{% csrf_token %}
								{% if is_registered %}
									{% if can_cancel %}
										<button type="submit" name="event_id" value="{{object.id}}" class="btn inverse">Already Registered, click again to cancel.</button>
									{% else %}
										<strong>No longer open for cancellation!</strong>
									{% endif %}
								{% elif is_waiting %}
									<button type="submit" name="event_id" value="{{object.id}}" class="btn inverse">In waiting list, click again to cancel.</button>
								{% else %}
									<button type="submit" name="event_id" value="{{object.id}}" class="btn">Click to register!</button>
								{% endif %}
							  </form>
							{% else %}
								<a class="btn" href="{% url 'home:index' %}?next={{ request.path|urlencode }}">Log in to register this event!</a><br>
							{% endif %}
						{% else %}
							<strong>No longer open for registration!</strong>
						{% endif %}
					</div>
					{% if messages %}
						{% for message in messages %}
						  <p class="{{ message.tags }}" style="color: red;">{{ message }}</p>
						{% endfor %}
					{% endif %}
					{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
					{% if user.is_staff %}
						<div class="flexbox">
							<div>
								<p>Everything here is only visible to staffs!</p>
								<a href="{{ event.secret_url }}/">Attendance/Check-in form (This is only visible to staffs!)</a>
								<div>
									<table style="text-align: left;">
										{% for users in food_needs_information %}
											<tr>
												<td>{{ users.email }}</td>
												<td>{{ users.food_needs}}</td>
											</tr>
										{% endfor %}
									</table>
								</div>
							</div>
						</div>
					{% endif %}
				</div>
			</main>
			{% block footer %}
				{% include 'home/footer.html' %} 
			{% endblock footer %}
		</div>
	</body>
</html>
